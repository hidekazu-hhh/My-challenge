<div class="text-right">
<%= link_to '学習を登録する', new_post_path, class: "btn btn-outline-secondary"%>
</div>


<div class="card border-dark mb-3" style="max-width: 25rem;">
  <div class="card-header">
    <p class="d-flex justify-content-end">
  
   <% if current_user != @user %>
   <% if current_user.following?(@user) %>
   <%= link_to '- フォロー', user_relationships_path(@user.id), method: :delete, class: "btn-sm  btn-secondary" %>
   <% else %>
   <%= link_to '+ フォロー', user_relationships_path(@user.id), method: :POST, class:"btn-sm btn-secondary " %>
   <% end %>
 </p>
 <% end %>
 
     <% if @user.avatar_image.url.present? %>
        <div class='mt-3 mb-3'>
          <%= image_tag @user.avatar_image.url,
                        class: 'rounded-circle',
                        id: 'preview',
                        size: '65x65' %>
        </div>
         <% else %>
         <div class='mt-3 mb-3'>
         <%= image_pack_tag 'media/images/sample.jpeg',
                        class: 'rounded-circle',
                        id: 'preview',
                        size: '65x65' %>
        </div>
      <% end %>
     <%= @user.name %>
      <div class="d-flex">
     <%= link_to follows_user_path(@user), class: "btn btn-light" do %>
     <h6>フォロー<%= @following_users.count %></h6>
     <% end %>&nbsp;&nbsp;
     <%= link_to followers_user_path(@user), class: "btn btn-light" do %>
     <h6>フォロワー<%= @follower_users.count %></h6>
     <% end %>
   </div>
     <div class="text-right">
      <% if @user.id == current_user.id %>
       <%= link_to edit_user_path(@user) do %>
        <i class="fa-solid fa-gear size"></i>
       <% end %>
      <% end %>
     </div>
  </div>
  <div class="card-body text-dark">
    <h5 class="card-title">学習記録</h5>
    <p class="card-text"> <h4 class ="mt-1">学習数：<%= @study_record %></h4> </p>
     <i class="fa-solid fa-tag size"></i>
      <% @tags_user.each do |tag| %>
       <span style="font-size:15px; margin:2px;">
     <%= tag.name%>
     </span>
     <% end %>
  </div>
</div>


<div>
  <i class="fa-solid fa-tag size"></i>
  <% @tags_user.each do |tag| %>
  <%#自身に紐づいたタグを重複させず表示  %>
     <span style="font-size:15px; margin:2px;">
     <%= link_to "#{tag.name}", tag_path(tag) ,class:"btn btn-sm  btn-outline-secondary"%>
     </span>
  <% end %>
</div>

<div class="col-md-9">
  <%= month_calendar events: @posts do |date, posts| %>
  <%= date.day %>
  <% posts.each do |post| %>
    <div>
      <%=post.tags.map(&:name).join(', ') %>
    </div>
  <% end %>
  <% end %>
</div>

<%= render 'search_form', url:user_path(@user), q: @q %>
<div class="col-md-12">
<div class="card border-secondary mb-3" style="max-width: 30rem;">
<% @posts.each do |post| %>
  <div class="card-header"></div>
  <div class="card-body text-dark">
    <p class="card-text"><%= post.content%></p>
   <br>
    <br>
     <%= post.created_at.strftime('%Y/%m/%d') %>
    <br>
    <br>
    <i class="fa-solid fa-tag size"></i>
     <%= post.tags.map(&:name).join(', ')%>
    <br>
     <br>
    <div class='mr10 float-left'>
      <span style=" margin-right:10px;">
        <%= link_to post_path(post) do %>
        <i class="fa-regular fa-file-lines size"></i>
      </span>
      <% end %>
    </div>
     <div class='mr10 float-left'>
    <span style="margin:10px;">
      <%= link_to "#" do %>
      <i class="fa-regular fa-comment size"></i>
    </span>
    </div>
      <% end %>
   <div class='mr10 float-left'>
    <div id="favorite_btn_<%= post.id %>">
     <%= render partial: 'favorites/favorite',locals: {post: post} %>
    </div>
    </div>
  </div>
  <% end %>
</div>
<%= paginate @posts, theme: 'twitter-bootstrap-4' %>
</div>
